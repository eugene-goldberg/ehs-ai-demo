{
  "metadata": {
    "title": "EHS Data Extraction Report - QueryType.UTILITY_CONSUMPTION",
    "generated_at": "2025-08-18T19:58:35.277852",
    "query_type": "utility_consumption",
    "parameters": {
      "start_date": "2025-06-01",
      "end_date": "2025-06-30"
    },
    "output_format": "json"
  },
  "summary": {
    "total_queries": 2,
    "successful_queries": 2,
    "failed_queries": 0,
    "total_records": 1,
    "graph_objects": [
      {
        "nodes": [
          {
            "labels": [
              "Document",
              "Waterbill"
            ],
            "count": 2
          },
          {
            "labels": [
              "WaterBill"
            ],
            "count": 2
          },
          {
            "labels": [
              "Facility"
            ],
            "count": 3
          },
          {
            "labels": [
              "Customer"
            ],
            "count": 3
          },
          {
            "labels": [
              "UtilityProvider"
            ],
            "count": 3
          },
          {
            "labels": [
              "Meter"
            ],
            "count": 4
          },
          {
            "labels": [
              "Emission"
            ],
            "count": 3
          },
          {
            "labels": [
              "DocumentChunk"
            ],
            "count": 3
          },
          {
            "labels": [
              "__Node__",
              "Chunk"
            ],
            "count": 6
          },
          {
            "labels": [
              "__Node__",
              "__Entity__",
              "entity"
            ],
            "count": 19
          },
          {
            "labels": [
              "Document",
              "Utilitybill"
            ],
            "count": 1
          },
          {
            "labels": [
              "UtilityBill"
            ],
            "count": 1
          }
        ],
        "relationships": [
          {
            "type": "EXTRACTED_TO",
            "count": 3
          },
          {
            "type": "BILLED_TO",
            "count": 6
          },
          {
            "type": "BILLED_FOR",
            "count": 6
          },
          {
            "type": "PROVIDED_BY",
            "count": 4
          },
          {
            "type": "MONITORS",
            "count": 11
          },
          {
            "type": "RECORDED_IN",
            "count": 5
          },
          {
            "type": "RESULTED_IN",
            "count": 3
          },
          {
            "type": "MENTIONS",
            "count": 19
          },
          {
            "type": "Is",
            "count": 10
          },
          {
            "type": "SOURCE",
            "count": 3
          }
        ],
        "total_nodes": 50,
        "total_relationships": 70
      }
    ]
  },
  "queries_executed": [
    {
      "query": "\n                MATCH (d:Document:UtilityBill)-[:EXTRACTED_TO]->(b:UtilityBill)\n                RETURN d, b\n                ORDER BY b.billing_period_end DESC\n                ",
      "parameters": {
        "start_date": "2025-06-01",
        "end_date": "2025-06-30"
      }
    },
    {
      "query": "\n                MATCH (b:UtilityBill)\n                WHERE b.billing_period_start >= $start_date \n                  AND b.billing_period_end <= $end_date\n                RETURN SUM(b.total_kwh) as total_consumption,\n                       AVG(b.total_cost) as avg_cost,\n                       COUNT(b) as bill_count\n                ",
      "parameters": {
        "start_date": "2025-06-01",
        "end_date": "2025-06-30"
      }
    }
  ],
  "query_results": [
    {
      "query": "\n                MATCH (d:Document:UtilityBill)-[:EXTRACTED_TO]->(b:UtilityBill)\n                RETURN d, b\n                ORDER BY b.billing_period_end DESC\n                ",
      "parameters": {
        "start_date": "2025-06-01",
        "end_date": "2025-06-30"
      },
      "results": [],
      "record_count": 0,
      "status": "success"
    },
    {
      "query": "\n                MATCH (b:UtilityBill)\n                WHERE b.billing_period_start >= $start_date \n                  AND b.billing_period_end <= $end_date\n                RETURN SUM(b.total_kwh) as total_consumption,\n                       AVG(b.total_cost) as avg_cost,\n                       COUNT(b) as bill_count\n                ",
      "parameters": {
        "start_date": "2025-06-01",
        "end_date": "2025-06-30"
      },
      "results": [
        {
          "total_consumption": 130000,
          "avg_cost": 15432.89,
          "bill_count": 1
        }
      ],
      "record_count": 1,
      "status": "success"
    }
  ],
  "analysis": {
    "Key Findings": {
      "1": "Two queries were executed successfully.",
      "2": "The first query, which was intended to extract utility bill documents, did not return any records.",
      "3": "The second query, which was intended to calculate total consumption, average cost, and bill count for the specified period, returned one record.",
      "4": "The total consumption for the period from June 1, 2025, to June 30, 2025, was 130,000 kWh.",
      "5": "The average cost for the same period was $15,432.89.",
      "6": "Only one utility bill was recorded for the specified period."
    },
    "Patterns or Trends": {
      "1": "There is no discernible pattern or trend from the available data as only one record was retrieved."
    },
    "Potential Data Quality Issues": {
      "1": "The first query did not return any records, which could indicate a data quality issue. The utility bill documents for the specified period may be missing or incorrectly tagged in the database.",
      "2": "The second query returned only one record, which could suggest that data for the specified period is incomplete. It is unusual to have only one utility bill for an entire month."
    },
    "Recommendations": {
      "1": "Investigate why the first query did not return any records. Check the database for missing or incorrectly tagged utility bill documents.",
      "2": "Verify the completeness of the data for the specified period. If there are more utility bills that were not included in the query results, they should be added to the database.",
      "3": "If the data is confirmed to be complete and accurate, consider adjusting the parameters of the queries to retrieve more comprehensive data."
    }
  },
  "errors": []
}