{
  "metadata": {
    "title": "EHS Data Extraction Report - QueryType.WATER_CONSUMPTION",
    "generated_at": "2025-08-18T19:30:18.971707",
    "query_type": "water_consumption",
    "parameters": {},
    "output_format": "json"
  },
  "summary": {
    "total_queries": 4,
    "successful_queries": 3,
    "failed_queries": 1,
    "total_records": 0,
    "graph_objects": [
      {
        "nodes": [
          {
            "labels": [
              "__Node__",
              "__Entity__",
              "entity"
            ],
            "count": 15
          },
          {
            "labels": [
              "__Node__",
              "Chunk"
            ],
            "count": 2
          },
          {
            "labels": [
              "Document",
              "Wastemanifest"
            ],
            "count": 1
          },
          {
            "labels": [
              "WasteManifest"
            ],
            "count": 1
          },
          {
            "labels": [
              "WasteShipment"
            ],
            "count": 1
          },
          {
            "labels": [
              "WasteGenerator"
            ],
            "count": 1
          },
          {
            "labels": [
              "Transporter"
            ],
            "count": 1
          },
          {
            "labels": [
              "DisposalFacility"
            ],
            "count": 1
          },
          {
            "labels": [
              "WasteItem"
            ],
            "count": 1
          },
          {
            "labels": [
              "Emission"
            ],
            "count": 1
          },
          {
            "labels": [
              "DocumentChunk"
            ],
            "count": 2
          }
        ],
        "relationships": [
          {
            "type": "MENTIONS",
            "count": 15
          },
          {
            "type": "Is",
            "count": 8
          },
          {
            "type": "SOURCE",
            "count": 1
          },
          {
            "type": "TRACKS",
            "count": 1
          },
          {
            "type": "DOCUMENTS",
            "count": 1
          },
          {
            "type": "GENERATED_BY",
            "count": 1
          },
          {
            "type": "TRANSPORTED_BY",
            "count": 1
          },
          {
            "type": "DISPOSED_AT",
            "count": 1
          },
          {
            "type": "CONTAINS_WASTE",
            "count": 1
          },
          {
            "type": "RESULTED_IN",
            "count": 1
          }
        ],
        "total_nodes": 27,
        "total_relationships": 31
      }
    ]
  },
  "queries_executed": [
    {
      "query": "\n                MATCH (d:Document:Waterbill)-[:EXTRACTED_TO]->(w:WaterBill)\n                RETURN d, w\n                ORDER BY w.billing_period_end DESC\n                ",
      "parameters": {}
    },
    {
      "query": "\n                MATCH (w:WaterBill)\n                RETURN w\n                ORDER BY w.billing_period_end DESC\n                ",
      "parameters": {}
    },
    {
      "query": "\n                MATCH (w:WaterBill)-[:BILLED_TO]->(f:Facility)\n                MATCH (w)-[:BILLED_FOR]->(c:Customer)\n                MATCH (w)-[:PROVIDED_BY]->(p:UtilityProvider)\n                OPTIONAL MATCH (w)-[:RESULTED_IN]->(e:Emission)\n                OPTIONAL MATCH (m:Meter)-[:RECORDED_IN]->(w)\n                RETURN w, f, c, p, e, collect(m) as meters\n                ORDER BY w.billing_period_end DESC\n                ",
      "parameters": {}
    },
    {
      "query": "\n                MATCH (w:WaterBill)\n                WHERE w.billing_period_start >= $start_date \n                  AND w.billing_period_end <= $end_date\n                RETURN SUM(w.total_gallons) as total_water_usage,\n                       AVG(w.total_cost) as avg_cost,\n                       COUNT(w) as bill_count\n                ",
      "parameters": {}
    }
  ],
  "query_results": [
    {
      "query": "\n                MATCH (d:Document:Waterbill)-[:EXTRACTED_TO]->(w:WaterBill)\n                RETURN d, w\n                ORDER BY w.billing_period_end DESC\n                ",
      "parameters": {},
      "results": [],
      "record_count": 0,
      "status": "success"
    },
    {
      "query": "\n                MATCH (w:WaterBill)\n                RETURN w\n                ORDER BY w.billing_period_end DESC\n                ",
      "parameters": {},
      "results": [],
      "record_count": 0,
      "status": "success"
    },
    {
      "query": "\n                MATCH (w:WaterBill)-[:BILLED_TO]->(f:Facility)\n                MATCH (w)-[:BILLED_FOR]->(c:Customer)\n                MATCH (w)-[:PROVIDED_BY]->(p:UtilityProvider)\n                OPTIONAL MATCH (w)-[:RESULTED_IN]->(e:Emission)\n                OPTIONAL MATCH (m:Meter)-[:RECORDED_IN]->(w)\n                RETURN w, f, c, p, e, collect(m) as meters\n                ORDER BY w.billing_period_end DESC\n                ",
      "parameters": {},
      "results": [],
      "record_count": 0,
      "status": "success"
    },
    {
      "query": "\n                MATCH (w:WaterBill)\n                WHERE w.billing_period_start >= $start_date \n                  AND w.billing_period_end <= $end_date\n                RETURN SUM(w.total_gallons) as total_water_usage,\n                       AVG(w.total_cost) as avg_cost,\n                       COUNT(w) as bill_count\n                ",
      "parameters": {},
      "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
      "status": "failed"
    }
  ],
  "analysis": {
    "Key Findings": {
      "1": "A total of 4 queries were executed, out of which 3 were successful and 1 failed.",
      "2": "The failed query was due to missing parameters 'start_date' and 'end_date'.",
      "3": "Despite the successful execution of 3 queries, no records were retrieved."
    },
    "Patterns or Trends": {
      "1": "All queries were related to water consumption data, specifically water bills.",
      "2": "The queries were designed to extract data from different relationships such as 'EXTRACTED_TO', 'BILLED_TO', 'BILLED_FOR', 'PROVIDED_BY', 'RESULTED_IN', and 'RECORDED_IN'.",
      "3": "All successful queries returned an empty result set, indicating a possible lack of data in the queried relationships."
    },
    "Potential Data Quality Issues": {
      "1": "The lack of returned records from the successful queries suggests that there might be missing or incomplete data in the database.",
      "2": "The failed query indicates that there might be issues with the input parameters, specifically 'start_date' and 'end_date'."
    },
    "Recommendations": {
      "1": "Investigate the database to ensure that it contains the necessary data for the queried relationships.",
      "2": "Check the input parameters for the failed query and ensure that 'start_date' and 'end_date' are provided.",
      "3": "If the database is confirmed to have the necessary data, review the queries to ensure they are correctly structured and targeted."
    }
  },
  "errors": []
}