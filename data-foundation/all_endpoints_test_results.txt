[2025-08-18 16:15:20] === COMPREHENSIVE EHS API ENDPOINTS TEST ===
[2025-08-18 16:15:20] Testing all three EHS extraction endpoints on port 8005
[2025-08-18 16:15:20] Test Date: 2025-08-18 16:15:20

[2025-08-18 16:15:20] Checking server health...
[0;32mâœ… Server is accessible on port 8005[0m

[2025-08-18 16:15:20] Starting endpoint tests...

[0;34m========================================[0m
[2025-08-18 16:15:20] TESTING: Electrical Consumption Extraction
[2025-08-18 16:15:20] URL: http://localhost:8005/api/v1/extract/electrical-consumption
[0;34m========================================[0m
[2025-08-18 16:15:20] Sending POST request with empty JSON body: '{}'
[2025-08-18 16:15:29] HTTP Status Code: 200
[2025-08-18 16:15:29] Request Time: 8.338793s
[0;32mâœ… SUCCESS: Electrical Consumption Extraction responded successfully[0m
[2025-08-18 16:15:29] Response (formatted JSON):
{
  "status": "success",
  "message": "Electrical consumption data extracted successfully",
  "data": {
    "query_type": "utility_consumption",
    "facility_filter": null,
    "date_range": null,
    "include_emissions": true,
    "include_cost_analysis": true,
    "report_data": {
      "metadata": {
        "title": "EHS Data Extraction Report - QueryType.UTILITY_CONSUMPTION",
        "generated_at": "2025-08-18T21:15:29.014991",
        "query_type": "utility_consumption",
        "parameters": {},
        "output_format": "json"
      },
      "summary": {
        "total_queries": 2,
        "successful_queries": 1,
        "failed_queries": 1,
        "total_records": 0,
        "graph_objects": [
          {
            "nodes": [
              {
                "labels": [
                  "Document",
                  "Waterbill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "WaterBill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "Facility"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Customer"
                ],
                "count": 3
              },
              {
                "labels": [
                  "UtilityProvider"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Meter"
                ],
                "count": 4
              },
              {
                "labels": [
                  "Emission"
                ],
                "count": 3
              },
              {
                "labels": [
                  "DocumentChunk"
                ],
                "count": 3
              },
              {
                "labels": [
                  "__Node__",
                  "Chunk"
                ],
                "count": 6
              },
              {
                "labels": [
                  "__Node__",
                  "__Entity__",
                  "entity"
                ],
                "count": 19
              },
              {
                "labels": [
                  "Document",
                  "Utilitybill"
                ],
                "count": 1
              },
              {
                "labels": [
                  "UtilityBill"
                ],
                "count": 1
              }
            ],
            "relationships": [
              {
                "type": "EXTRACTED_TO",
                "count": 3
              },
              {
                "type": "BILLED_TO",
                "count": 6
              },
              {
                "type": "BILLED_FOR",
                "count": 6
              },
              {
                "type": "PROVIDED_BY",
                "count": 4
              },
              {
                "type": "MONITORS",
                "count": 11
              },
              {
                "type": "RECORDED_IN",
                "count": 5
              },
              {
                "type": "RESULTED_IN",
                "count": 3
              },
              {
                "type": "MENTIONS",
                "count": 19
              },
              {
                "type": "Is",
                "count": 10
              },
              {
                "type": "SOURCE",
                "count": 3
              }
            ],
            "total_nodes": 50,
            "total_relationships": 70
          }
        ]
      },
      "queries_executed": [
        {
          "query": "\n                MATCH (d:Document:UtilityBill)-[:EXTRACTED_TO]->(b:UtilityBill)\n                RETURN d, b\n                ORDER BY b.billing_period_end DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (b:UtilityBill)\n                WHERE b.billing_period_start >= $start_date \n                  AND b.billing_period_end <= $end_date\n                RETURN SUM(b.total_kwh) as total_consumption,\n                       AVG(b.total_cost) as avg_cost,\n                       COUNT(b) as bill_count\n                ",
          "parameters": {}
        }
      ],
      "query_results": [
        {
          "query": "\n                MATCH (d:Document:UtilityBill)-[:EXTRACTED_TO]->(b:UtilityBill)\n                RETURN d, b\n                ORDER BY b.billing_period_end DESC\n                ",
          "parameters": {},
          "results": [],
          "record_count": 0,
          "status": "success"
        },
        {
          "query": "\n                MATCH (b:UtilityBill)\n                WHERE b.billing_period_start >= $start_date \n                  AND b.billing_period_end <= $end_date\n                RETURN SUM(b.total_kwh) as total_consumption,\n                       AVG(b.total_cost) as avg_cost,\n                       COUNT(b) as bill_count\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        }
      ],
      "analysis": {
        "Key Findings": {
          "1": "Two queries were executed, one was successful and the other failed.",
          "2": "The successful query did not retrieve any records.",
          "3": "The failed query was due to missing parameters 'start_date' and 'end_date'."
        },
        "Patterns or Trends": {
          "1": "There is a pattern of missing parameters in the queries, which leads to failure in execution."
        },
        "Potential Data Quality Issues": {
          "1": "The successful query did not return any records, indicating a potential issue with the data source or the query itself.",
          "2": "The failed query indicates that the required parameters were not provided, which could be due to a lack of data or incorrect data input."
        },
        "Recommendations": {
          "1": "Check the data source or the query for the successful query that did not return any records to ensure it is correctly set up and the data is available.",
          "2": "Ensure all required parameters are provided for the queries to prevent failures.",
          "3": "Implement a system to validate the parameters before executing the queries to prevent such failures in the future."
        }
      },
      "errors": []
    },
    "file_path": "reports/ehs_report_QueryType.UTILITY_CONSUMPTION_20250818_211529.json"
  },
  "metadata": {
    "total_queries": 2,
    "successful_queries": 1,
    "total_records": 0,
    "processing_status": "completed",
    "generated_at": "2025-08-18T21:15:20.687756"
  },
  "processing_time": 8.329982,
  "errors": []
}

[2025-08-18 16:15:29] RESPONSE SUMMARY:
[2025-08-18 16:15:29] - Status: success
[2025-08-18 16:15:29] - Message: Electrical consumption data extracted successfully
[2025-08-18 16:15:29] - Total Records: 0
[2025-08-18 16:15:29] - Processing Time: 8.329982s
[2025-08-18 16:15:29] - Successful Queries: 1/2

[0;34m========================================[0m
[2025-08-18 16:15:29] TESTING: Water Consumption Extraction
[2025-08-18 16:15:29] URL: http://localhost:8005/api/v1/extract/water-consumption
[0;34m========================================[0m
[2025-08-18 16:15:29] Sending POST request with empty JSON body: '{}'
[2025-08-18 16:15:43] HTTP Status Code: 200
[2025-08-18 16:15:43] Request Time: 14.142329s
[0;32mâœ… SUCCESS: Water Consumption Extraction responded successfully[0m
[2025-08-18 16:15:43] Response (formatted JSON):
{
  "status": "success",
  "message": "Water consumption data extracted successfully",
  "data": {
    "query_type": "water_consumption",
    "facility_filter": null,
    "date_range": null,
    "include_meter_details": true,
    "include_emissions": true,
    "report_data": {
      "metadata": {
        "title": "EHS Data Extraction Report - QueryType.WATER_CONSUMPTION",
        "generated_at": "2025-08-18T21:15:43.334682",
        "query_type": "water_consumption",
        "parameters": {},
        "output_format": "json"
      },
      "summary": {
        "total_queries": 4,
        "successful_queries": 3,
        "failed_queries": 1,
        "total_records": 23,
        "graph_objects": [
          {
            "nodes": [
              {
                "labels": [
                  "Document",
                  "Waterbill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "WaterBill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "Facility"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Customer"
                ],
                "count": 3
              },
              {
                "labels": [
                  "UtilityProvider"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Meter"
                ],
                "count": 4
              },
              {
                "labels": [
                  "Emission"
                ],
                "count": 3
              },
              {
                "labels": [
                  "DocumentChunk"
                ],
                "count": 3
              },
              {
                "labels": [
                  "__Node__",
                  "Chunk"
                ],
                "count": 6
              },
              {
                "labels": [
                  "__Node__",
                  "__Entity__",
                  "entity"
                ],
                "count": 19
              },
              {
                "labels": [
                  "Document",
                  "Utilitybill"
                ],
                "count": 1
              },
              {
                "labels": [
                  "UtilityBill"
                ],
                "count": 1
              }
            ],
            "relationships": [
              {
                "type": "EXTRACTED_TO",
                "count": 3
              },
              {
                "type": "BILLED_TO",
                "count": 6
              },
              {
                "type": "BILLED_FOR",
                "count": 6
              },
              {
                "type": "PROVIDED_BY",
                "count": 4
              },
              {
                "type": "MONITORS",
                "count": 11
              },
              {
                "type": "RECORDED_IN",
                "count": 5
              },
              {
                "type": "RESULTED_IN",
                "count": 3
              },
              {
                "type": "MENTIONS",
                "count": 19
              },
              {
                "type": "Is",
                "count": 10
              },
              {
                "type": "SOURCE",
                "count": 3
              }
            ],
            "total_nodes": 50,
            "total_relationships": 70
          }
        ]
      },
      "queries_executed": [
        {
          "query": "\n                MATCH (d:Document:Waterbill)-[:EXTRACTED_TO]->(w:WaterBill)\n                RETURN d, w\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                RETURN w\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                OPTIONAL MATCH (w)-[:BILLED_TO]->(f:Facility)\n                OPTIONAL MATCH (w)-[:BILLED_FOR]->(c:Customer)\n                OPTIONAL MATCH (w)-[:PROVIDED_BY]->(p:UtilityProvider)\n                OPTIONAL MATCH (w)-[:RESULTED_IN]->(e:Emission)\n                OPTIONAL MATCH (m:Meter)-[:RECORDED_IN]->(w)\n                RETURN w, f, c, p, e, collect(m) as meters\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                WHERE w.billing_period_start >= $start_date \n                  AND w.billing_period_end <= $end_date\n                RETURN SUM(w.total_gallons) as total_water_usage,\n                       AVG(w.total_cost) as avg_cost,\n                       COUNT(w) as bill_count\n                ",
          "parameters": {}
        }
      ],
      "query_results": [
        {
          "query": "\n                MATCH (d:Document:Waterbill)-[:EXTRACTED_TO]->(w:WaterBill)\n                RETURN d, w\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {},
          "results": [
            {
              "d": {
                "id": 0,
                "labels": [
                  "Waterbill",
                  "Document"
                ],
                "properties": {
                  "file_path": "data/water_bill.pdf",
                  "uploaded_at": "2025-08-18T19:50:27.315042",
                  "id": "water_bill_20250818_144959",
                  "source": "test",
                  "type": "water_bill",
                  "document_type": "water_bill"
                }
              },
              "w": {
                "id": 1,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_144959",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              }
            },
            {
              "d": {
                "id": 40,
                "labels": [
                  "Waterbill",
                  "Document"
                ],
                "properties": {
                  "file_path": "data/water_bill.pdf",
                  "uploaded_at": "2025-08-18T19:57:09.590360",
                  "id": "water_bill_20250818_145639",
                  "source": "batch_ingestion",
                  "type": "water_bill",
                  "document_type": "water_bill"
                }
              },
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              }
            }
          ],
          "record_count": 2,
          "status": "success"
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                RETURN w\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {},
          "results": [
            {
              "w": {
                "id": 1,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_144959",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              }
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              }
            }
          ],
          "record_count": 2,
          "status": "success"
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                OPTIONAL MATCH (w)-[:BILLED_TO]->(f:Facility)\n                OPTIONAL MATCH (w)-[:BILLED_FOR]->(c:Customer)\n                OPTIONAL MATCH (w)-[:PROVIDED_BY]->(p:UtilityProvider)\n                OPTIONAL MATCH (w)-[:RESULTED_IN]->(e:Emission)\n                OPTIONAL MATCH (m:Meter)-[:RECORDED_IN]->(w)\n                RETURN w, f, c, p, e, collect(m) as meters\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {},
          "results": [
            {
              "w": {
                "id": 1,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_144959",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 6,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_144959"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            }
          ],
          "record_count": 19,
          "status": "success"
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                WHERE w.billing_period_start >= $start_date \n                  AND w.billing_period_end <= $end_date\n                RETURN SUM(w.total_gallons) as total_water_usage,\n                       AVG(w.total_cost) as avg_cost,\n                       COUNT(w) as bill_count\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        }
      ],
      "analysis": {
        "Key Findings": [
          {
            "Finding": "The total number of queries executed was 4, out of which 3 were successful.",
            "Implication": "This indicates a high success rate of 75% for the queries executed."
          },
          {
            "Finding": "The total records retrieved from the successful queries were 23.",
            "Implication": "This suggests that the queries were able to extract a substantial amount of data."
          },
          {
            "Finding": "The water consumption cost is consistently high across the records.",
            "Implication": "This could indicate high water usage or high water rates."
          },
          {
            "Finding": "The total gallons of water consumed is the same across the records.",
            "Implication": "This could suggest a consistent water consumption pattern."
          }
        ],
        "Patterns or Trends": [
          {
            "Pattern": "The water bills have the same total cost, water consumption cost, and total gallons across the records.",
            "Implication": "This could suggest a consistent billing pattern or a lack of variability in the data."
          }
        ],
        "Potential Data Quality Issues": [
          {
            "Issue": "The source of the water bill documents varies ('test' and 'batch_ingestion').",
            "Implication": "This could potentially affect the consistency and reliability of the data."
          },
          {
            "Issue": "The same water bill data appears to be repeated in the query results.",
            "Implication": "This could indicate duplicate records in the data."
          }
        ],
        "Recommendations": [
          {
            "Recommendation": "Investigate the source of the water bill documents to ensure data consistency and reliability."
          },
          {
            "Recommendation": "Check for duplicate records in the data and clean if necessary."
          },
          {
            "Recommendation": "Further investigate the high water consumption cost to identify potential reasons and solutions."
          }
        ]
      },
      "errors": []
    },
    "file_path": "reports/ehs_report_QueryType.WATER_CONSUMPTION_20250818_211543.json"
  },
  "metadata": {
    "total_queries": 4,
    "successful_queries": 3,
    "total_records": 23,
    "processing_status": "completed",
    "generated_at": "2025-08-18T21:15:29.141326"
  },
  "processing_time": 14.200033,
  "errors": []
}

[2025-08-18 16:15:43] RESPONSE SUMMARY:
[2025-08-18 16:15:43] - Status: success
[2025-08-18 16:15:43] - Message: Water consumption data extracted successfully
[2025-08-18 16:15:43] - Total Records: 23
[2025-08-18 16:15:43] - Processing Time: 14.200033s
[2025-08-18 16:15:43] - Successful Queries: 3/4

[0;34m========================================[0m
[2025-08-18 16:15:43] TESTING: Waste Generation Extraction
[2025-08-18 16:15:43] URL: http://localhost:8005/api/v1/extract/waste-generation
[0;34m========================================[0m
[2025-08-18 16:15:43] Sending POST request with empty JSON body: '{}'
[2025-08-18 16:15:54] HTTP Status Code: 200
[2025-08-18 16:15:54] Request Time: 11.299973s
[0;32mâœ… SUCCESS: Waste Generation Extraction responded successfully[0m
[2025-08-18 16:15:54] Response (formatted JSON):
{
  "status": "success",
  "message": "Waste generation data extracted successfully",
  "data": {
    "query_type": "waste_generation",
    "facility_filter": null,
    "date_range": null,
    "include_disposal_details": true,
    "include_transport_details": true,
    "include_emissions": true,
    "hazardous_only": false,
    "report_data": {
      "metadata": {
        "title": "EHS Data Extraction Report - QueryType.WASTE_GENERATION",
        "generated_at": "2025-08-18T21:15:54.754389",
        "query_type": "waste_generation",
        "parameters": {},
        "output_format": "json"
      },
      "summary": {
        "total_queries": 8,
        "successful_queries": 2,
        "failed_queries": 6,
        "total_records": 0,
        "graph_objects": [
          {
            "nodes": [
              {
                "labels": [
                  "Document",
                  "Waterbill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "WaterBill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "Facility"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Customer"
                ],
                "count": 3
              },
              {
                "labels": [
                  "UtilityProvider"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Meter"
                ],
                "count": 4
              },
              {
                "labels": [
                  "Emission"
                ],
                "count": 3
              },
              {
                "labels": [
                  "DocumentChunk"
                ],
                "count": 3
              },
              {
                "labels": [
                  "__Node__",
                  "Chunk"
                ],
                "count": 6
              },
              {
                "labels": [
                  "__Node__",
                  "__Entity__",
                  "entity"
                ],
                "count": 19
              },
              {
                "labels": [
                  "Document",
                  "Utilitybill"
                ],
                "count": 1
              },
              {
                "labels": [
                  "UtilityBill"
                ],
                "count": 1
              }
            ],
            "relationships": [
              {
                "type": "EXTRACTED_TO",
                "count": 3
              },
              {
                "type": "BILLED_TO",
                "count": 6
              },
              {
                "type": "BILLED_FOR",
                "count": 6
              },
              {
                "type": "PROVIDED_BY",
                "count": 4
              },
              {
                "type": "MONITORS",
                "count": 11
              },
              {
                "type": "RECORDED_IN",
                "count": 5
              },
              {
                "type": "RESULTED_IN",
                "count": 3
              },
              {
                "type": "MENTIONS",
                "count": 19
              },
              {
                "type": "Is",
                "count": 10
              },
              {
                "type": "SOURCE",
                "count": 3
              }
            ],
            "total_nodes": 50,
            "total_relationships": 70
          }
        ]
      },
      "queries_executed": [
        {
          "query": "\n                MATCH (d:Document:Wastemanifest)-[:TRACKS]->(wm:WasteManifest)\n                MATCH (wm)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:GENERATED_BY]->(g:WasteGenerator)\n                MATCH (ws)-[:TRANSPORTED_BY]->(t:Transporter)  \n                MATCH (ws)-[:DISPOSED_AT]->(df:DisposalFacility)\n                OPTIONAL MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                RETURN d, wm, ws, g, t, df, collect(wi) as waste_items, collect(e) as emissions\n                ORDER BY ws.shipment_date DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:GENERATED_BY]->(g:WasteGenerator)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN g.name as generator,\n                       g.epa_id as generator_epa_id,\n                       SUM(wi.quantity) as total_waste_quantity,\n                       wi.unit as quantity_unit,\n                       COUNT(DISTINCT wm) as manifest_count,\n                       COUNT(wi) as waste_item_count,\n                       SUM(e.amount) as total_emissions\n                ORDER BY total_waste_quantity DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:DISPOSED_AT]->(df:DisposalFacility)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN df.name as disposal_facility,\n                       df.epa_id as facility_epa_id,\n                       df.state as facility_state,\n                       COUNT(DISTINCT wm) as manifests_received,\n                       SUM(wi.quantity) as total_waste_received,\n                       wi.unit as quantity_unit,\n                       collect(DISTINCT wi.disposal_method) as disposal_methods,\n                       SUM(e.amount) as total_emissions_from_disposal\n                ORDER BY total_waste_received DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:TRANSPORTED_BY]->(t:Transporter)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN t.name as transporter,\n                       t.epa_id as transporter_epa_id,\n                       COUNT(DISTINCT wm) as manifests_transported,\n                       SUM(wi.quantity) as total_waste_transported,\n                       wi.unit as quantity_unit,\n                       COUNT(DISTINCT ws) as unique_shipments_transported,\n                       collect(DISTINCT ws.transport_method) as transport_methods\n                ORDER BY total_waste_transported DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN wi.waste_code as waste_code,\n                       wi.description as waste_description,\n                       COUNT(wi) as item_count,\n                       SUM(wi.quantity) as total_quantity,\n                       wi.unit as quantity_unit,\n                       collect(DISTINCT wi.disposal_method) as disposal_methods\n                ORDER BY total_quantity DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                WITH date(ws.shipment_date) as shipment_date, \n                     wm, \n                     ws,\n                     [(ws)-[:CONTAINS_WASTE]->(wi:WasteItem) | wi] as waste_items\n                RETURN shipment_date,\n                       COUNT(DISTINCT wm) as manifests_generated,\n                       SUM(reduce(total = 0, wi in waste_items | total + wi.quantity)) as daily_waste_total,\n                       AVG(ws.total_weight) as avg_shipment_weight\n                ORDER BY shipment_date DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN e.emission_type as emission_type,\n                       e.unit as emission_unit,\n                       COUNT(e) as emission_records,\n                       SUM(e.amount) as total_emissions,\n                       AVG(e.amount) as avg_emissions_per_record,\n                       SUM(wi.quantity) as associated_waste_quantity,\n                       AVG(e.amount / wi.quantity) as avg_emission_factor\n                ORDER BY total_emissions DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (d:Document:Wastemanifest)-[:TRACKS]->(wm:WasteManifest)\n                MATCH (wm)-[:DOCUMENTS]->(ws:WasteShipment)\n                WHERE d.status IS NOT NULL\n                OPTIONAL MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                RETURN d.status as manifest_status,\n                       COUNT(DISTINCT wm) as manifest_count,\n                       SUM(wi.quantity) as total_waste_quantity,\n                       MIN(ws.shipment_date) as earliest_shipment_date,\n                       MAX(ws.shipment_date) as latest_shipment_date,\n                       MIN(wm.issue_date) as earliest_issue_date,\n                       MAX(wm.issue_date) as latest_issue_date,\n                       COUNT(DISTINCT ws) as unique_shipments\n                ORDER BY manifest_count DESC\n                ",
          "parameters": {}
        }
      ],
      "query_results": [
        {
          "query": "\n                MATCH (d:Document:Wastemanifest)-[:TRACKS]->(wm:WasteManifest)\n                MATCH (wm)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:GENERATED_BY]->(g:WasteGenerator)\n                MATCH (ws)-[:TRANSPORTED_BY]->(t:Transporter)  \n                MATCH (ws)-[:DISPOSED_AT]->(df:DisposalFacility)\n                OPTIONAL MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                RETURN d, wm, ws, g, t, df, collect(wi) as waste_items, collect(e) as emissions\n                ORDER BY ws.shipment_date DESC\n                ",
          "parameters": {},
          "results": [],
          "record_count": 0,
          "status": "success"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:GENERATED_BY]->(g:WasteGenerator)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN g.name as generator,\n                       g.epa_id as generator_epa_id,\n                       SUM(wi.quantity) as total_waste_quantity,\n                       wi.unit as quantity_unit,\n                       COUNT(DISTINCT wm) as manifest_count,\n                       COUNT(wi) as waste_item_count,\n                       SUM(e.amount) as total_emissions\n                ORDER BY total_waste_quantity DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:DISPOSED_AT]->(df:DisposalFacility)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN df.name as disposal_facility,\n                       df.epa_id as facility_epa_id,\n                       df.state as facility_state,\n                       COUNT(DISTINCT wm) as manifests_received,\n                       SUM(wi.quantity) as total_waste_received,\n                       wi.unit as quantity_unit,\n                       collect(DISTINCT wi.disposal_method) as disposal_methods,\n                       SUM(e.amount) as total_emissions_from_disposal\n                ORDER BY total_waste_received DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:TRANSPORTED_BY]->(t:Transporter)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN t.name as transporter,\n                       t.epa_id as transporter_epa_id,\n                       COUNT(DISTINCT wm) as manifests_transported,\n                       SUM(wi.quantity) as total_waste_transported,\n                       wi.unit as quantity_unit,\n                       COUNT(DISTINCT ws) as unique_shipments_transported,\n                       collect(DISTINCT ws.transport_method) as transport_methods\n                ORDER BY total_waste_transported DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN wi.waste_code as waste_code,\n                       wi.description as waste_description,\n                       COUNT(wi) as item_count,\n                       SUM(wi.quantity) as total_quantity,\n                       wi.unit as quantity_unit,\n                       collect(DISTINCT wi.disposal_method) as disposal_methods\n                ORDER BY total_quantity DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                WITH date(ws.shipment_date) as shipment_date, \n                     wm, \n                     ws,\n                     [(ws)-[:CONTAINS_WASTE]->(wi:WasteItem) | wi] as waste_items\n                RETURN shipment_date,\n                       COUNT(DISTINCT wm) as manifests_generated,\n                       SUM(reduce(total = 0, wi in waste_items | total + wi.quantity)) as daily_waste_total,\n                       AVG(ws.total_weight) as avg_shipment_weight\n                ORDER BY shipment_date DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN e.emission_type as emission_type,\n                       e.unit as emission_unit,\n                       COUNT(e) as emission_records,\n                       SUM(e.amount) as total_emissions,\n                       AVG(e.amount) as avg_emissions_per_record,\n                       SUM(wi.quantity) as associated_waste_quantity,\n                       AVG(e.amount / wi.quantity) as avg_emission_factor\n                ORDER BY total_emissions DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (d:Document:Wastemanifest)-[:TRACKS]->(wm:WasteManifest)\n                MATCH (wm)-[:DOCUMENTS]->(ws:WasteShipment)\n                WHERE d.status IS NOT NULL\n                OPTIONAL MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                RETURN d.status as manifest_status,\n                       COUNT(DISTINCT wm) as manifest_count,\n                       SUM(wi.quantity) as total_waste_quantity,\n                       MIN(ws.shipment_date) as earliest_shipment_date,\n                       MAX(ws.shipment_date) as latest_shipment_date,\n                       MIN(wm.issue_date) as earliest_issue_date,\n                       MAX(wm.issue_date) as latest_issue_date,\n                       COUNT(DISTINCT ws) as unique_shipments\n                ORDER BY manifest_count DESC\n                ",
          "parameters": {},
          "results": [],
          "record_count": 0,
          "status": "success"
        }
      ],
      "analysis": {
        "Key Findings": {
          "1": "Out of 8 total queries executed, only 2 were successful.",
          "2": "No records were retrieved from the executed queries.",
          "3": "The successful query did not return any results.",
          "4": "The failed queries were due to missing parameters 'start_date' and 'end_date'."
        },
        "Patterns or Trends": {
          "1": "The queries are designed to extract information about waste generation, transportation, and disposal.",
          "2": "The queries are structured to retrieve data from a graph database, possibly Neo4j, as indicated by the Cypher query language used.",
          "3": "The queries are dependent on certain parameters (start_date, end_date) which were not provided, leading to their failure."
        },
        "Potential Data Quality Issues": {
          "1": "The lack of results from the successful query could indicate that there is no data in the database that matches the query criteria.",
          "2": "The failed queries indicate that the necessary parameters were not provided, which could be due to a lack of data validation or error handling in the query execution process."
        },
        "Recommendations": {
          "1": "Ensure that all necessary parameters are provided before executing queries.",
          "2": "Implement data validation and error handling mechanisms to prevent query failures due to missing parameters.",
          "3": "Investigate the database to ensure that it contains the necessary data for the queries to return results.",
          "4": "If the database is empty or the data is not structured as expected, it may be necessary to review the data ingestion process."
        }
      },
      "errors": []
    },
    "file_path": "reports/ehs_report_QueryType.WASTE_GENERATION_20250818_211554.json"
  },
  "metadata": {
    "total_queries": 8,
    "successful_queries": 2,
    "total_records": 0,
    "processing_status": "completed",
    "generated_at": "2025-08-18T21:15:43.469342"
  },
  "processing_time": 11.289297,
  "errors": []
}

[2025-08-18 16:15:54] RESPONSE SUMMARY:
[2025-08-18 16:15:54] - Status: success
[2025-08-18 16:15:54] - Message: Waste generation data extracted successfully
[2025-08-18 16:15:54] - Total Records: 0
[2025-08-18 16:15:54] - Processing Time: 11.289297s
[2025-08-18 16:15:54] - Successful Queries: 2/8

[0;34m========================================[0m
[2025-08-18 16:15:54] FINAL TEST SUMMARY
[0;34m========================================[0m
[2025-08-18 16:15:54] Total Endpoints Tested: 3
[2025-08-18 16:15:54] Successful Responses: 3
[2025-08-18 16:15:54] Failed Responses: 0
0

[2025-08-18 16:15:54] DATA EXTRACTION RESULTS:
[2025-08-18 16:15:54] - Electrical Consumption:  records
[2025-08-18 16:15:54] - Water Consumption:  records
[2025-08-18 16:15:54] - Waste Generation:  records

[0;32mðŸŽ‰ ALL TESTS PASSED! All 3 endpoints are working correctly.[0m

[2025-08-18 16:15:54] Test completed. Complete results saved to: all_endpoints_test_results.txt
[2025-08-18 16:15:54] === END OF TEST ===
[0;34m========================================[0m
