EHS API EXTRACTION ENDPOINT TEST RESULTS
Generated: Mon Aug 18 15:58:45 CDT 2025
API Base URL: http://localhost:8005/api/v1/extract
Test Script: ./ehs_extraction_test_script.sh
=================================================================

=================================================================
TEST: Utility Consumption Extraction (Electrical Data)
TIMESTAMP: Mon Aug 18 15:58:45 CDT 2025
=================================================================

Endpoint: http://localhost:8005/api/v1/extract/utility-consumption
Request: POST http://localhost:8005/api/v1/extract/utility-consumption
Payload: {}

HTTP Status Code: 404

ERROR RESPONSE:
{"detail":"Not Found"}
---End of Utility Consumption Extraction (Electrical Data) test---


=================================================================
TEST: Water Consumption Extraction
TIMESTAMP: Mon Aug 18 15:58:47 CDT 2025
=================================================================

Endpoint: http://localhost:8005/api/v1/extract/water-consumption
Request: POST http://localhost:8005/api/v1/extract/water-consumption
Payload: {}

HTTP Status Code: 200

RESPONSE (formatted with jq):
{
  "status": "success",
  "message": "Water consumption data extracted successfully",
  "data": {
    "query_type": "water_consumption",
    "facility_filter": null,
    "date_range": null,
    "include_meter_details": true,
    "include_emissions": true,
    "report_data": {
      "metadata": {
        "title": "EHS Data Extraction Report - QueryType.WATER_CONSUMPTION",
        "generated_at": "2025-08-18T20:59:03.933227",
        "query_type": "water_consumption",
        "parameters": {},
        "output_format": "json"
      },
      "summary": {
        "total_queries": 4,
        "successful_queries": 3,
        "failed_queries": 1,
        "total_records": 23,
        "graph_objects": [
          {
            "nodes": [
              {
                "labels": [
                  "Document",
                  "Waterbill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "WaterBill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "Facility"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Customer"
                ],
                "count": 3
              },
              {
                "labels": [
                  "UtilityProvider"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Meter"
                ],
                "count": 4
              },
              {
                "labels": [
                  "Emission"
                ],
                "count": 3
              },
              {
                "labels": [
                  "DocumentChunk"
                ],
                "count": 3
              },
              {
                "labels": [
                  "__Node__",
                  "Chunk"
                ],
                "count": 6
              },
              {
                "labels": [
                  "__Node__",
                  "__Entity__",
                  "entity"
                ],
                "count": 19
              },
              {
                "labels": [
                  "Document",
                  "Utilitybill"
                ],
                "count": 1
              },
              {
                "labels": [
                  "UtilityBill"
                ],
                "count": 1
              }
            ],
            "relationships": [
              {
                "type": "EXTRACTED_TO",
                "count": 3
              },
              {
                "type": "BILLED_TO",
                "count": 6
              },
              {
                "type": "BILLED_FOR",
                "count": 6
              },
              {
                "type": "PROVIDED_BY",
                "count": 4
              },
              {
                "type": "MONITORS",
                "count": 11
              },
              {
                "type": "RECORDED_IN",
                "count": 5
              },
              {
                "type": "RESULTED_IN",
                "count": 3
              },
              {
                "type": "MENTIONS",
                "count": 19
              },
              {
                "type": "Is",
                "count": 10
              },
              {
                "type": "SOURCE",
                "count": 3
              }
            ],
            "total_nodes": 50,
            "total_relationships": 70
          }
        ]
      },
      "queries_executed": [
        {
          "query": "\n                MATCH (d:Document:Waterbill)-[:EXTRACTED_TO]->(w:WaterBill)\n                RETURN d, w\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                RETURN w\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                OPTIONAL MATCH (w)-[:BILLED_TO]->(f:Facility)\n                OPTIONAL MATCH (w)-[:BILLED_FOR]->(c:Customer)\n                OPTIONAL MATCH (w)-[:PROVIDED_BY]->(p:UtilityProvider)\n                OPTIONAL MATCH (w)-[:RESULTED_IN]->(e:Emission)\n                OPTIONAL MATCH (m:Meter)-[:RECORDED_IN]->(w)\n                RETURN w, f, c, p, e, collect(m) as meters\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                WHERE w.billing_period_start >= $start_date \n                  AND w.billing_period_end <= $end_date\n                RETURN SUM(w.total_gallons) as total_water_usage,\n                       AVG(w.total_cost) as avg_cost,\n                       COUNT(w) as bill_count\n                ",
          "parameters": {}
        }
      ],
      "query_results": [
        {
          "query": "\n                MATCH (d:Document:Waterbill)-[:EXTRACTED_TO]->(w:WaterBill)\n                RETURN d, w\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {},
          "results": [
            {
              "d": {
                "id": 0,
                "labels": [
                  "Waterbill",
                  "Document"
                ],
                "properties": {
                  "file_path": "data/water_bill.pdf",
                  "uploaded_at": "2025-08-18T19:50:27.315042",
                  "id": "water_bill_20250818_144959",
                  "source": "test",
                  "type": "water_bill",
                  "document_type": "water_bill"
                }
              },
              "w": {
                "id": 1,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_144959",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              }
            },
            {
              "d": {
                "id": 40,
                "labels": [
                  "Waterbill",
                  "Document"
                ],
                "properties": {
                  "file_path": "data/water_bill.pdf",
                  "uploaded_at": "2025-08-18T19:57:09.590360",
                  "id": "water_bill_20250818_145639",
                  "source": "batch_ingestion",
                  "type": "water_bill",
                  "document_type": "water_bill"
                }
              },
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              }
            }
          ],
          "record_count": 2,
          "status": "success"
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                RETURN w\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {},
          "results": [
            {
              "w": {
                "id": 1,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_144959",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              }
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              }
            }
          ],
          "record_count": 2,
          "status": "success"
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                OPTIONAL MATCH (w)-[:BILLED_TO]->(f:Facility)\n                OPTIONAL MATCH (w)-[:BILLED_FOR]->(c:Customer)\n                OPTIONAL MATCH (w)-[:PROVIDED_BY]->(p:UtilityProvider)\n                OPTIONAL MATCH (w)-[:RESULTED_IN]->(e:Emission)\n                OPTIONAL MATCH (m:Meter)-[:RECORDED_IN]->(w)\n                RETURN w, f, c, p, e, collect(m) as meters\n                ORDER BY w.billing_period_end DESC\n                ",
          "parameters": {},
          "results": [
            {
              "w": {
                "id": 1,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_144959",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 6,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_144959"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 44,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 25,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "attention": "Accounts Payable",
                  "billing_address": "456 Industrial Ave. Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 3,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 2,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 42,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            },
            {
              "w": {
                "id": 41,
                "labels": [
                  "WaterBill"
                ],
                "properties": {
                  "stormwater_fee": 125.0,
                  "total_cost": 4891.5,
                  "sewer_service_charge": 950.0,
                  "due_date": "2025-08-05",
                  "billing_period_end": "2025-06-30",
                  "water_consumption_cost": 3750.0,
                  "total_gallons": 250000,
                  "billing_period_start": "2025-06-01",
                  "id": "water_bill_water_bill_20250818_145639",
                  "infrastructure_surcharge": 5.0,
                  "conservation_tax": 61.5
                }
              },
              "f": {
                "id": 24,
                "labels": [
                  "Facility"
                ],
                "properties": {
                  "address": "789 Production Way, Mechanicsburg, CA 93011",
                  "name": "Apex Manufacturing - Plant A",
                  "id": "facility_apex_manufacturing___plant_a"
                }
              },
              "c": {
                "id": 43,
                "labels": [
                  "Customer"
                ],
                "properties": {
                  "name": "Apex Manufacturing Inc.",
                  "billing_address": "456 Industrial Ave., Mechanicsburg, CA 93011",
                  "id": "customer_apex_manufacturing_inc"
                }
              },
              "p": {
                "id": 4,
                "labels": [
                  "UtilityProvider"
                ],
                "properties": {
                  "website": "www.aquaflow.gov",
                  "address": "789 Reservoir Road, Clearwater, CA 90330",
                  "phone": "(800) 555-0211",
                  "name": "Aquaflow Municipal Water",
                  "id": "provider_aquaflow_municipal_water"
                }
              },
              "e": {
                "id": 46,
                "labels": [
                  "Emission"
                ],
                "properties": {
                  "emission_factor": 0.0002,
                  "amount": 50.0,
                  "unit": "kg_CO2",
                  "calculation_method": "water_treatment_distribution_factor",
                  "source_type": "water",
                  "id": "emission_water_bill_20250818_145639"
                }
              },
              "meters": [
                {
                  "id": 5,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                },
                {
                  "id": 45,
                  "labels": [
                    "Meter"
                  ],
                  "properties": {
                    "unit": "gallons",
                    "service_type": "Commercial",
                    "previous_reading": 8765400,
                    "usage": 250000,
                    "current_reading": 9015400,
                    "id": "WTR-MAIN-01",
                    "type": "water"
                  }
                }
              ]
            }
          ],
          "record_count": 19,
          "status": "success"
        },
        {
          "query": "\n                MATCH (w:WaterBill)\n                WHERE w.billing_period_start >= $start_date \n                  AND w.billing_period_end <= $end_date\n                RETURN SUM(w.total_gallons) as total_water_usage,\n                       AVG(w.total_cost) as avg_cost,\n                       COUNT(w) as bill_count\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        }
      ],
      "analysis": {
        "Key Findings": [
          {
            "Finding": "The total number of queries executed was 4, out of which 3 were successful.",
            "Implication": "This indicates a high success rate of 75% for the queries executed."
          },
          {
            "Finding": "The total number of records retrieved from the successful queries was 23.",
            "Implication": "This suggests that the queries were able to extract a substantial amount of data."
          },
          {
            "Finding": "The water consumption cost is consistently high across the records.",
            "Implication": "This could indicate high water usage or high water rates."
          },
          {
            "Finding": "The total gallons of water consumed is the same across the records.",
            "Implication": "This could suggest a consistent water consumption pattern."
          }
        ],
        "Patterns or Trends": [
          {
            "Pattern": "The water bills have the same structure and similar values across different records.",
            "Implication": "This could suggest a standard billing structure and consistent water usage."
          }
        ],
        "Potential Data Quality Issues": [
          {
            "Issue": "The source of the water bill documents varies ('test' and 'batch_ingestion').",
            "Implication": "This could potentially affect the consistency and reliability of the data."
          },
          {
            "Issue": "The same water bill appears to be uploaded multiple times with different IDs.",
            "Implication": "This could lead to data duplication and skew the analysis."
          }
        ],
        "Recommendations": [
          {
            "Recommendation": "Investigate the high water consumption cost to identify potential ways to reduce it."
          },
          {
            "Recommendation": "Ensure the consistency and reliability of the data by standardizing the source of the water bill documents."
          },
          {
            "Recommendation": "Implement measures to prevent data duplication, such as checking for existing records before uploading a new water bill."
          }
        ]
      },
      "errors": []
    },
    "file_path": "reports/ehs_report_QueryType.WATER_CONSUMPTION_20250818_205903.json"
  },
  "metadata": {
    "total_queries": 4,
    "successful_queries": 3,
    "total_records": 23,
    "processing_status": "completed",
    "generated_at": "2025-08-18T20:58:47.745376"
  },
  "processing_time": 16.195311,
  "errors": []
}

---End of Water Consumption Extraction test---


=================================================================
TEST: Waste Generation Extraction
TIMESTAMP: Mon Aug 18 15:59:05 CDT 2025
=================================================================

Endpoint: http://localhost:8005/api/v1/extract/waste-generation
Request: POST http://localhost:8005/api/v1/extract/waste-generation
Payload: {}

HTTP Status Code: 200

RESPONSE (formatted with jq):
{
  "status": "success",
  "message": "Waste generation data extracted successfully",
  "data": {
    "query_type": "waste_generation",
    "facility_filter": null,
    "date_range": null,
    "include_disposal_details": true,
    "include_transport_details": true,
    "include_emissions": true,
    "hazardous_only": false,
    "report_data": {
      "metadata": {
        "title": "EHS Data Extraction Report - QueryType.WASTE_GENERATION",
        "generated_at": "2025-08-18T20:59:17.348370",
        "query_type": "waste_generation",
        "parameters": {},
        "output_format": "json"
      },
      "summary": {
        "total_queries": 8,
        "successful_queries": 2,
        "failed_queries": 6,
        "total_records": 0,
        "graph_objects": [
          {
            "nodes": [
              {
                "labels": [
                  "Document",
                  "Waterbill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "WaterBill"
                ],
                "count": 2
              },
              {
                "labels": [
                  "Facility"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Customer"
                ],
                "count": 3
              },
              {
                "labels": [
                  "UtilityProvider"
                ],
                "count": 3
              },
              {
                "labels": [
                  "Meter"
                ],
                "count": 4
              },
              {
                "labels": [
                  "Emission"
                ],
                "count": 3
              },
              {
                "labels": [
                  "DocumentChunk"
                ],
                "count": 3
              },
              {
                "labels": [
                  "__Node__",
                  "Chunk"
                ],
                "count": 6
              },
              {
                "labels": [
                  "__Node__",
                  "__Entity__",
                  "entity"
                ],
                "count": 19
              },
              {
                "labels": [
                  "Document",
                  "Utilitybill"
                ],
                "count": 1
              },
              {
                "labels": [
                  "UtilityBill"
                ],
                "count": 1
              }
            ],
            "relationships": [
              {
                "type": "EXTRACTED_TO",
                "count": 3
              },
              {
                "type": "BILLED_TO",
                "count": 6
              },
              {
                "type": "BILLED_FOR",
                "count": 6
              },
              {
                "type": "PROVIDED_BY",
                "count": 4
              },
              {
                "type": "MONITORS",
                "count": 11
              },
              {
                "type": "RECORDED_IN",
                "count": 5
              },
              {
                "type": "RESULTED_IN",
                "count": 3
              },
              {
                "type": "MENTIONS",
                "count": 19
              },
              {
                "type": "Is",
                "count": 10
              },
              {
                "type": "SOURCE",
                "count": 3
              }
            ],
            "total_nodes": 50,
            "total_relationships": 70
          }
        ]
      },
      "queries_executed": [
        {
          "query": "\n                MATCH (d:Document:Wastemanifest)-[:TRACKS]->(wm:WasteManifest)\n                MATCH (wm)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:GENERATED_BY]->(g:WasteGenerator)\n                MATCH (ws)-[:TRANSPORTED_BY]->(t:Transporter)  \n                MATCH (ws)-[:DISPOSED_AT]->(df:DisposalFacility)\n                OPTIONAL MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                RETURN d, wm, ws, g, t, df, collect(wi) as waste_items, collect(e) as emissions\n                ORDER BY ws.shipment_date DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:GENERATED_BY]->(g:WasteGenerator)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN g.name as generator,\n                       g.epa_id as generator_epa_id,\n                       SUM(wi.quantity) as total_waste_quantity,\n                       wi.unit as quantity_unit,\n                       COUNT(DISTINCT wm) as manifest_count,\n                       COUNT(wi) as waste_item_count,\n                       SUM(e.amount) as total_emissions\n                ORDER BY total_waste_quantity DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:DISPOSED_AT]->(df:DisposalFacility)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN df.name as disposal_facility,\n                       df.epa_id as facility_epa_id,\n                       df.state as facility_state,\n                       COUNT(DISTINCT wm) as manifests_received,\n                       SUM(wi.quantity) as total_waste_received,\n                       wi.unit as quantity_unit,\n                       collect(DISTINCT wi.disposal_method) as disposal_methods,\n                       SUM(e.amount) as total_emissions_from_disposal\n                ORDER BY total_waste_received DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:TRANSPORTED_BY]->(t:Transporter)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN t.name as transporter,\n                       t.epa_id as transporter_epa_id,\n                       COUNT(DISTINCT wm) as manifests_transported,\n                       SUM(wi.quantity) as total_waste_transported,\n                       wi.unit as quantity_unit,\n                       COUNT(DISTINCT ws) as unique_shipments_transported,\n                       collect(DISTINCT ws.transport_method) as transport_methods\n                ORDER BY total_waste_transported DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN wi.waste_code as waste_code,\n                       wi.description as waste_description,\n                       COUNT(wi) as item_count,\n                       SUM(wi.quantity) as total_quantity,\n                       wi.unit as quantity_unit,\n                       collect(DISTINCT wi.disposal_method) as disposal_methods\n                ORDER BY total_quantity DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                WITH date(ws.shipment_date) as shipment_date, \n                     wm, \n                     ws,\n                     [(ws)-[:CONTAINS_WASTE]->(wi:WasteItem) | wi] as waste_items\n                RETURN shipment_date,\n                       COUNT(DISTINCT wm) as manifests_generated,\n                       SUM(reduce(total = 0, wi in waste_items | total + wi.quantity)) as daily_waste_total,\n                       AVG(ws.total_weight) as avg_shipment_weight\n                ORDER BY shipment_date DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN e.emission_type as emission_type,\n                       e.unit as emission_unit,\n                       COUNT(e) as emission_records,\n                       SUM(e.amount) as total_emissions,\n                       AVG(e.amount) as avg_emissions_per_record,\n                       SUM(wi.quantity) as associated_waste_quantity,\n                       AVG(e.amount / wi.quantity) as avg_emission_factor\n                ORDER BY total_emissions DESC\n                ",
          "parameters": {}
        },
        {
          "query": "\n                MATCH (d:Document:Wastemanifest)-[:TRACKS]->(wm:WasteManifest)\n                MATCH (wm)-[:DOCUMENTS]->(ws:WasteShipment)\n                WHERE d.status IS NOT NULL\n                OPTIONAL MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                RETURN d.status as manifest_status,\n                       COUNT(DISTINCT wm) as manifest_count,\n                       SUM(wi.quantity) as total_waste_quantity,\n                       MIN(ws.shipment_date) as earliest_shipment_date,\n                       MAX(ws.shipment_date) as latest_shipment_date,\n                       MIN(wm.issue_date) as earliest_issue_date,\n                       MAX(wm.issue_date) as latest_issue_date,\n                       COUNT(DISTINCT ws) as unique_shipments\n                ORDER BY manifest_count DESC\n                ",
          "parameters": {}
        }
      ],
      "query_results": [
        {
          "query": "\n                MATCH (d:Document:Wastemanifest)-[:TRACKS]->(wm:WasteManifest)\n                MATCH (wm)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:GENERATED_BY]->(g:WasteGenerator)\n                MATCH (ws)-[:TRANSPORTED_BY]->(t:Transporter)  \n                MATCH (ws)-[:DISPOSED_AT]->(df:DisposalFacility)\n                OPTIONAL MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                RETURN d, wm, ws, g, t, df, collect(wi) as waste_items, collect(e) as emissions\n                ORDER BY ws.shipment_date DESC\n                ",
          "parameters": {},
          "results": [],
          "record_count": 0,
          "status": "success"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:GENERATED_BY]->(g:WasteGenerator)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN g.name as generator,\n                       g.epa_id as generator_epa_id,\n                       SUM(wi.quantity) as total_waste_quantity,\n                       wi.unit as quantity_unit,\n                       COUNT(DISTINCT wm) as manifest_count,\n                       COUNT(wi) as waste_item_count,\n                       SUM(e.amount) as total_emissions\n                ORDER BY total_waste_quantity DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:DISPOSED_AT]->(df:DisposalFacility)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                OPTIONAL MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN df.name as disposal_facility,\n                       df.epa_id as facility_epa_id,\n                       df.state as facility_state,\n                       COUNT(DISTINCT wm) as manifests_received,\n                       SUM(wi.quantity) as total_waste_received,\n                       wi.unit as quantity_unit,\n                       collect(DISTINCT wi.disposal_method) as disposal_methods,\n                       SUM(e.amount) as total_emissions_from_disposal\n                ORDER BY total_waste_received DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:TRANSPORTED_BY]->(t:Transporter)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN t.name as transporter,\n                       t.epa_id as transporter_epa_id,\n                       COUNT(DISTINCT wm) as manifests_transported,\n                       SUM(wi.quantity) as total_waste_transported,\n                       wi.unit as quantity_unit,\n                       COUNT(DISTINCT ws) as unique_shipments_transported,\n                       collect(DISTINCT ws.transport_method) as transport_methods\n                ORDER BY total_waste_transported DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN wi.waste_code as waste_code,\n                       wi.description as waste_description,\n                       COUNT(wi) as item_count,\n                       SUM(wi.quantity) as total_quantity,\n                       wi.unit as quantity_unit,\n                       collect(DISTINCT wi.disposal_method) as disposal_methods\n                ORDER BY total_quantity DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                WITH date(ws.shipment_date) as shipment_date, \n                     wm, \n                     ws,\n                     [(ws)-[:CONTAINS_WASTE]->(wi:WasteItem) | wi] as waste_items\n                RETURN shipment_date,\n                       COUNT(DISTINCT wm) as manifests_generated,\n                       SUM(reduce(total = 0, wi in waste_items | total + wi.quantity)) as daily_waste_total,\n                       AVG(ws.total_weight) as avg_shipment_weight\n                ORDER BY shipment_date DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (wm:WasteManifest)-[:DOCUMENTS]->(ws:WasteShipment)\n                MATCH (ws)-[:RESULTED_IN]->(e:Emission)\n                MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                WHERE ws.shipment_date >= $start_date \n                  AND ws.shipment_date <= $end_date\n                RETURN e.emission_type as emission_type,\n                       e.unit as emission_unit,\n                       COUNT(e) as emission_records,\n                       SUM(e.amount) as total_emissions,\n                       AVG(e.amount) as avg_emissions_per_record,\n                       SUM(wi.quantity) as associated_waste_quantity,\n                       AVG(e.amount / wi.quantity) as avg_emission_factor\n                ORDER BY total_emissions DESC\n                ",
          "parameters": {},
          "error": "{code: Neo.ClientError.Statement.ParameterMissing} {message: Expected parameter(s): start_date, end_date}",
          "status": "failed"
        },
        {
          "query": "\n                MATCH (d:Document:Wastemanifest)-[:TRACKS]->(wm:WasteManifest)\n                MATCH (wm)-[:DOCUMENTS]->(ws:WasteShipment)\n                WHERE d.status IS NOT NULL\n                OPTIONAL MATCH (ws)-[:CONTAINS_WASTE]->(wi:WasteItem)\n                RETURN d.status as manifest_status,\n                       COUNT(DISTINCT wm) as manifest_count,\n                       SUM(wi.quantity) as total_waste_quantity,\n                       MIN(ws.shipment_date) as earliest_shipment_date,\n                       MAX(ws.shipment_date) as latest_shipment_date,\n                       MIN(wm.issue_date) as earliest_issue_date,\n                       MAX(wm.issue_date) as latest_issue_date,\n                       COUNT(DISTINCT ws) as unique_shipments\n                ORDER BY manifest_count DESC\n                ",
          "parameters": {},
          "results": [],
          "record_count": 0,
          "status": "success"
        }
      ],
      "analysis": {
        "Key Findings": {
          "1": "A total of 8 queries were executed, out of which only 2 were successful.",
          "2": "No records were retrieved from the executed queries.",
          "3": "The successful query did not return any results.",
          "4": "The failed queries were due to missing parameters, specifically 'start_date' and 'end_date'."
        },
        "Patterns or Trends": {
          "1": "The queries are designed to extract information about waste generation, transportation, and disposal.",
          "2": "The queries are structured to retrieve data about waste shipments, waste generators, transporters, disposal facilities, waste items, and emissions.",
          "3": "The queries are sorted by shipment date and total waste quantity."
        },
        "Potential Data Quality Issues": {
          "1": "The main issue is the lack of required parameters in some queries, which led to their failure.",
          "2": "The successful query did not return any data, which could indicate a lack of data in the database or an issue with the query itself.",
          "3": "The absence of data makes it impossible to assess the quality of the data."
        },
        "Recommendations": {
          "1": "Ensure that all required parameters are provided when executing queries.",
          "2": "Check the successful query to ensure it is correctly structured and that the database contains the required data.",
          "3": "Consider implementing data validation checks to prevent the execution of queries with missing parameters."
        }
      },
      "errors": []
    },
    "file_path": "reports/ehs_report_QueryType.WASTE_GENERATION_20250818_205917.json"
  },
  "metadata": {
    "total_queries": 8,
    "successful_queries": 2,
    "total_records": 0,
    "processing_status": "completed",
    "generated_at": "2025-08-18T20:59:06.017447"
  },
  "processing_time": 11.333542,
  "errors": []
}

---End of Waste Generation Extraction test---


=================================================================
TEST: TEST SUMMARY
TIMESTAMP: Mon Aug 18 15:59:19 CDT 2025
=================================================================

All extraction endpoint tests completed.
Total endpoints tested: 3
- POST /api/v1/extract/utility-consumption
- POST /api/v1/extract/water-consumption
- POST /api/v1/extract/waste-generation

Test completed at: Mon Aug 18 15:59:19 CDT 2025
=================================================================
